// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mongodb"
  url      = env("DATABASE_URL")
}

model Player {
  id           String    @id @default(auto()) @map("_id") @db.ObjectId
  name         String
  email        String?
  phone        String?
  team         String?   // e.g., "U20", "U18", "U16", "U14", "U10"
  jerseyNumber Int?
  photo        String?   // Cloudinary URL
  joinDate     DateTime  @default(now())
  active       Boolean   @default(true)
  createdAt    DateTime  @default(now())
  updatedAt    DateTime  @updatedAt
  payments     Payment[]
}

model Payment {
  id                 String    @id @default(auto()) @map("_id") @db.ObjectId
  playerId           String    @db.ObjectId
  player             Player    @relation(fields: [playerId], references: [id], onDelete: Cascade)
  month              Int       // 1-12
  year               Int       // e.g., 2024
  amount             Float     // Payment amount (per invoice)
  status             String    @default("pending") // "paid", "pending", "overdue"
  paidDate           DateTime?
  notes              String?
  // Payment plan fields
  paymentType        String    @default("monthly") // "monthly" | "installment"
  planId             String?   // groups all invoices of the same plan
  planStartDate      DateTime? // start date of the plan
  planEndDate        DateTime? // end date of the plan
  dueDate            DateTime? // when this specific invoice is due
  installmentNumber  Int?      // which installment this is (1-based)
  totalInstallments  Int?      // total installments in the plan
  createdAt          DateTime  @default(now())
  updatedAt          DateTime  @updatedAt
}

model Admin {
  id        String   @id @default(auto()) @map("_id") @db.ObjectId
  username  String   @unique
  password  String   // In production, this should be hashed
  name      String?
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}
